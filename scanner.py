import nmap
import socket

def scan_ports(ip, port_range):
    nm = nmap.PortScanner()
    nm.scan(ip, port_range)
    return nm

def check_vulnerabilities(ip, open_ports):
    vulnerabilities = []
    for port in open_ports:
        if port == 22:
            vulnerabilities.append(f"Port 22 (SSH) might be vulnerable to Brute Force attacks.")
        elif port == 80:
            vulnerabilities.append(f"Port 80 (HTTP) might be vulnerable to common web exploits.")
        elif port == 443:
            vulnerabilities.append(f"Port 443 (HTTPS) might be vulnerable to outdated SSL/TLS configurations.")
        # Add more port-specific vulnerabilities as needed
    return vulnerabilities

def main():
    target_ip = input("Enter the target IP address: ")
    port_range = input("Enter the port range (e.g., 1-65535): ")
    
    print(f"Scanning IP: {target_ip} on ports {port_range}...")
    nm = scan_ports(target_ip, port_range)
    
    open_ports = []
    for port in nm[target_ip]['tcp']:
        if nm[target_ip]['tcp'][port]['state'] == 'open':
            open_ports.append(port)
    
    if open_ports:
        print(f"Open ports: {open_ports}")
        vulnerabilities = check_vulnerabilities(target_ip, open_ports)
        if vulnerabilities:
            print("Potential vulnerabilities:")
            for vuln in vulnerabilities:
                print(f"- {vuln}")
        else:
            print("No common vulnerabilities detected.")
    else:
        print("No open ports found.")

if __name__ == "__main__":
    main()
